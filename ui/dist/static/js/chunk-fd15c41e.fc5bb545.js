(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fd15c41e"],{"0905":function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"a",(function(){return o}));var s=a("b775");function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",r={};return e&&(r["uid"]=e),a&&(r["kind"]=a),o&&(r["namespace"]=o),n&&(r["name"]=n),Object(s["a"])({url:"event/".concat(t),method:"get",params:r})}function o(t){if(t){var e=t.lastTimestamp;return e||(e=t.firstTimestamp),e||(e=t.metadata.creationTimestamp),{uid:t.metadata.uid,namespace:t.metadata.namespace,count:t.spec?t.spec.count:1,reason:t.reason,message:t.message,type:t.type,object:t.involvedObject,source:t.source,event_time:e,resource_version:t.metadata.resourceVersion}}}},6193:function(t,e,a){},6720:function(t,e,a){"use strict";var s=a("cc8c"),n=a.n(s);n.a},7725:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("clusterbar",{attrs:{titleName:t.titleName,delFunc:t.deleteStatefulSets,editFunc:t.getStatefulSetYaml}}),a("div",{staticClass:"dashboard-container"},[a("div",{staticStyle:{padding:"10px 8px 0px"}},[a("div",[t._v("基本信息")]),a("el-form",{staticClass:"pod-item",staticStyle:{margin:"15px 10px 30px 10px"},attrs:{"label-position":"left",inline:""}},[a("el-form-item",{attrs:{label:"名称"}},[a("span",[t._v(t._s(t.statefulset.name))])]),a("el-form-item",{attrs:{label:"创建时间"}},[a("span",[t._v(t._s(t.statefulset.created))])]),a("el-form-item",{attrs:{label:"命名空间"}},[a("span",[t._v(t._s(t.statefulset.namespace))])]),a("el-form-item",{attrs:{label:"更新策略"}},[a("span",[t._v(t._s(t.statefulset.strategy))])]),a("el-form-item",{attrs:{label:"Pod副本"}},[a("span",[t._v(t._s(t.statefulset.ready_replicas+"/"+t.statefulset.status_replicas))])]),a("el-form-item",{attrs:{label:"选择器"}},[t.statefulset.label_selector?t._l(t.statefulset.label_selector.matchLabels,(function(e,s){return[a("span",{key:s},[t._v(t._s(s)+": "+t._s(e)),a("br")])]})):a("span",[t._v("—")])],2),a("el-form-item",{attrs:{label:"标签"}},[t.statefulset.labels?t._l(t.statefulset.labels,(function(e,s){return[a("span",{key:s},[t._v(t._s(s)+": "+t._s(e)),a("br")])]})):a("span",[t._v("—")])],2)],1)],1),a("div",{staticStyle:{padding:"0px 8px"}},[a("div",[t._v("Pods")]),a("div",{staticClass:"msgClass",staticStyle:{margin:"15px 10px 20px 10px"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",staticClass:"table-fix",staticStyle:{width:"100%"},attrs:{data:t.pods,"tooltip-effect":"dark","cell-style":t.cellStyle,"default-sort":{prop:"name"}}},[a("el-table-column",{attrs:{prop:"name",label:"名称","min-width":"150","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"name-class",on:{click:function(a){return t.namePodClick(e.row.namespace,e.row.name)}}},[t._v(" "+t._s(e.row.name)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"containerNum",label:"容器","min-width":"45","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.init_containers?t._l(e.row.init_containers,(function(e){return a("el-tooltip",{key:e.name,attrs:{content:e.name+" ("+e.status+")",placement:"top"}},[a("svg-icon",{class:t.containerClass(e.status),staticStyle:{"margin-top":"7px"},attrs:{"icon-class":"square"}})],1)})):t._e(),t._l(e.row.containers,(function(e){return a("el-tooltip",{key:e.name,attrs:{content:e.name+" ("+e.status+")",placement:"top"}},[a("svg-icon",{class:t.containerClass(e.status),staticStyle:{"margin-top":"7px"},attrs:{"icon-class":"square"}})],1)}))]}}])}),a("el-table-column",{attrs:{prop:"restarts",label:"重启","min-width":"45","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"node_name",label:"节点","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"ip",label:"IP","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"created",label:"创建时间","min-width":"100","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"status",label:"状态","min-width":"60","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"","show-overflow-tooltip":"",width:"45"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-dropdown",{attrs:{size:"medium"}},[a("el-link",{attrs:{underline:!1}},[a("svg-icon",{staticStyle:{width:"1.3em",height:"1.3em"},attrs:{"icon-class":"operate"}})],1),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t.$podOpPerm("get")?a("el-dropdown-item",{nativeOn:{click:function(a){return a.preventDefault(),t.namePodClick(e.row.namespace,e.row.name)}}},[a("svg-icon",{staticStyle:{width:"1.3em",height:"1.3em","line-height":"40px","vertical-align":"-0.25em"},attrs:{"icon-class":"detail"}}),a("span",{staticStyle:{"margin-left":"5px"}},[t._v("详情")])],1):t._e(),t.$podOpPerm("get")?a("div",{on:{mouseover:function(e){t.logContainerShow=!0},mouseout:function(e){t.logContainerShow=!1}}},[a("el-dropdown-item",{nativeOn:{click:function(a){a.preventDefault(),t.selectContainer=e.row.containers[0].name,t.selectPodName=e.row.name,t.logDialog=!0}}},[a("div",{staticClass:"download"},[a("div",[a("svg-icon",{staticStyle:{width:"1.3em",height:"1.3em","line-height":"40px","vertical-align":"-0.25em"},attrs:{"icon-class":"log"}}),a("span",{staticStyle:{"margin-left":"5px"}},[t._v("日志")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.row.containerNum>1&&t.logContainerShow,expression:"scope.row.containerNum > 1 && logContainerShow"}],staticClass:"download-right"},[t._l(e.row.init_containers,(function(s){return a("div",{key:s.name,staticClass:"download-item",on:{click:function(a){t.selectContainer=s.name,t.selectPodName=e.row.name,t.logDialog=!0}}},[t._v(" "+t._s(s.name)+" ")])})),t._l(e.row.containers,(function(s){return a("div",{key:s.name,staticClass:"download-item",on:{click:function(a){t.selectContainer=s.name,t.selectPodName=e.row.name,t.logDialog=!0}}},[t._v(" "+t._s(s.name)+" ")])}))],2)])])],1):t._e(),t.$podOpPerm("update")?a("div",{on:{mouseover:function(e){t.termContainerShow=!0},mouseout:function(e){t.termContainerShow=!1}}},[a("el-dropdown-item",{nativeOn:{click:function(a){a.preventDefault(),t.selectContainer=e.row.containers[0].name,t.selectPodName=e.row.name,t.terminalDialog=!0}}},[a("div",{staticClass:"download"},[a("div",[a("svg-icon",{staticStyle:{width:"1.3em",height:"1.3em","line-height":"40px","vertical-align":"-0.25em"},attrs:{"icon-class":"terminal"}}),a("span",{staticStyle:{"margin-left":"5px"}},[t._v("终端")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.row.containers.length>1&&t.termContainerShow,expression:"scope.row.containers.length > 1 && termContainerShow"}],staticClass:"download-right"},t._l(e.row.containers,(function(s){return a("div",{key:s.name,staticClass:"download-item",on:{click:function(a){t.selectContainer=s.name,t.selectPodName=e.row.name,t.terminalDialog=!0}}},[t._v(" "+t._s(s.name)+" ")])})),0)])])],1):t._e(),t.$podOpPerm("delete")?a("el-dropdown-item",{nativeOn:{click:function(a){return a.preventDefault(),t.deletePods([{namespace:e.row.namespace,name:e.row.name}])}}},[a("svg-icon",{staticStyle:{width:"1.3em",height:"1.3em","line-height":"40px","vertical-align":"-0.25em"},attrs:{"icon-class":"delete"}}),a("span",{staticStyle:{"margin-left":"5px"}},[t._v("删除")])],1):t._e()],1)],1)]}}])})],1)],1)]),a("el-tabs",{staticStyle:{padding:"0px 8px"},attrs:{value:"containers"}},[a("el-tab-pane",{attrs:{label:"容器",name:"containers"}},[a("div",{staticClass:"msgClass"},[a("el-table",{ref:"table",staticClass:"table-fix",staticStyle:{width:"100%"},attrs:{data:t.containers,"tooltip-effect":"dark","cell-style":t.cellStyle,"default-sort":{prop:"name"}}},[a("el-table-column",{staticStyle:{overflow:"hidden"},attrs:{type:"expand",width:"20"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form",{staticClass:"table-expand",attrs:{"label-position":"left",inline:""}},[a("el-form-item",{attrs:{label:"容器名称"}},[a("span",[t._v(t._s(e.row.name))])]),a("el-form-item",{attrs:{label:"镜像"}},[a("span",[t._v(t._s(e.row.image))])]),e.row.command.length?a("el-form-item",{attrs:{label:"启动命令"}},[t._l(e.row.command,(function(e){return[a("span",{key:e},[t._v(t._s(e)),a("br")])]}))],2):t._e(),e.row.args.length?a("el-form-item",{attrs:{label:"启动参数"}},[t._l(e.row.args,(function(e){return[a("span",{key:e},[t._v(t._s(e)),a("br")])]}))],2):t._e(),e.row.ports.length?a("el-form-item",{attrs:{label:"端口"}},[t._l(e.row.ports,(function(e){return[a("span",{key:e.name},[t._v(t._s(e.name?e.name+":":"")+" "+t._s(e.containerPort)+"/"+t._s(e.protocol)),a("br")])]}))],2):t._e(),e.row.env.length?a("el-form-item",{attrs:{label:"环境变量"}},[t._l(e.row.env,(function(e,s){return[a("span",{key:s},[t._v(" "+t._s(t.envStr(e))),a("br")])]}))],2):t._e(),e.row.volume_mounts.length?a("el-form-item",{attrs:{label:"目录挂载"}},[t._l(e.row.volume_mounts,(function(e){return[a("span",{key:e.name},[t._v(t._s(e.name)+" -> "+t._s(e.mountPath)+" ("+t._s(e.readOnly?"ro":"rw")+")"),a("br")])]}))],2):t._e(),e.row.resources&&(e.row.resources.requests||e.row.resources.limits)?a("el-form-item",{attrs:{label:"资源"}},[a("div",[a("span",{staticStyle:{width:"80px",display:"inline-block"}}),a("span",{staticStyle:{width:"80px",display:"inline-block"}},[t._v("预留")]),a("span",{staticStyle:{display:"inline-block"}},[t._v("限制")])]),a("div",{staticStyle:{"margin-top":"-10px"}},[a("span",{staticStyle:{width:"80px",display:"inline-block"}},[t._v("cpu")]),a("span",{staticStyle:{width:"80px",display:"inline-block"}},[t._v(t._s(t.resourceFor(e.row.resources,"requests","cpu")))]),a("span",{staticStyle:{display:"inline-block"}},[t._v(t._s(t.resourceFor(e.row.resources,"limits","cpu")))])]),a("div",{staticStyle:{"margin-top":"-10px"}},[a("span",{staticStyle:{width:"80px",display:"inline-block"}},[t._v("memory")]),a("span",{staticStyle:{width:"80px",display:"inline-block"}},[t._v(t._s(t.resourceFor(e.row.resources,"requests","memory")))]),a("span",{staticStyle:{display:"inline-block"}},[t._v(t._s(t.resourceFor(e.row.resources,"limits","memory")))])])]):t._e(),e.row.readiness_probe||e.row.liveness_probe?a("el-form-item",{attrs:{label:"健康检查"}},t._l(["readiness_probe","liveness_probe"],(function(s){return a("div",{key:s},[e.row[s]?a("div",[a("div",[a("span",{staticStyle:{"margin-right":"15px","font-weight":"450"}},[t._v(" "+t._s("readiness_probe"==s?"ReadinessProbe":"LivenessProbe")+" ")])]),a("div",{staticStyle:{"margin-top":"-15px"}},t._l(e.row[s],(function(e,s){return a("span",{key:s},[["httpGet","exec","tcpSocket"].indexOf(s)>-1?a("span",{staticClass:"back-class"},[t._v(" "+t._s(s)+": "+t._s(e)+" ")]):t._e()])})),0),a("div",{staticStyle:{"margin-top":"-10px"}},t._l(e.row[s],(function(e,s){return a("span",{key:s},[["httpGet","exec","tcpSocket"].indexOf(s)<=-1?a("span",{staticClass:"back-class"},[t._v(" "+t._s(s)+": "+t._s(e)+" ")]):t._e()])})),0)]):t._e()])})),0):t._e()],1)]}}])}),a("el-table-column",{attrs:{prop:"name",label:"名称","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"name-class",on:{click:function(a){return t.toogleExpand(e.row)}}},[t._v(" "+t._s(e.row.name)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"image",label:"镜像","min-width":"","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"image_pull_policy",label:"镜像拉取策略","min-width":"","show-overflow-tooltip":""}})],1)],1)]),a("el-tab-pane",{attrs:{label:"存储",name:"volumes"}},[a("div",{staticClass:"msgClass",staticStyle:{padding:"10px 0px"}},t._l(t.statefulset.volumes,(function(e){return a("div",{key:e.name,staticStyle:{margin:"15px 25px","font-size":"14px",color:"#606266"}},[a("div",{staticStyle:{"margin-bottom":"6px"}},[a("b",[t._v(t._s(e.name))])]),t._l(e,(function(e,s){return["name"!==s?a("span",{key:s},[a("span",{staticClass:"back-class"},[t._v(t._s(s))]),t._l(e,(function(e,s){return a("span",{key:s,staticClass:"back-class"},[t._v(" "+t._s(s)+": "+t._s(e)+" ")])}))],2):t._e()]}))],2)})),0)]),a("el-tab-pane",{attrs:{label:"状态",name:"conditions"}},[a("div",{staticClass:"msgClass"},[t.statefulset&&t.statefulset.conditions&&t.statefulset.conditions.length>0?a("el-table",{staticClass:"table-fix",staticStyle:{width:"100%"},attrs:{data:t.statefulset.conditions,"tooltip-effect":"dark","cell-style":t.cellStyle,"default-sort":{prop:"lastProbeTime"}}},[a("el-table-column",{attrs:{prop:"type",label:"类型","min-width":"30","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"status",label:"状态","min-width":"20","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"reason",label:"原因","min-width":"50","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(" "+t._s(e.row.reason?e.row.reason:"—")+" ")])]}}],null,!1,548534711)}),a("el-table-column",{attrs:{prop:"message",label:"信息","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(" "+t._s(e.row.message?e.row.message:"—")+" ")])]}}],null,!1,2501580055)}),a("el-table-column",{attrs:{label:"触发时间","min-width":"40","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(" "+t._s(e.row.lastProbeTime?e.row.lastProbeTime:e.row.lastTransitionTime)+" ")])]}}],null,!1,2572631955)})],1):a("div",{staticStyle:{padding:"25px 15px",color:"#909399","text-align":"center"}},[t._v("暂无数据")])],1)]),a("el-tab-pane",{attrs:{label:"事件",name:"events"}},[a("div",{staticClass:"msgClass"},[t.statefulsetEvents&&t.statefulsetEvents.length>0?a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.eventLoading,expression:"eventLoading"}],staticClass:"table-fix",staticStyle:{width:"100%"},attrs:{data:t.statefulsetEvents,"tooltip-effect":"dark","cell-style":t.cellStyle,"default-sort":{prop:"event_time",order:"descending"}}},[a("el-table-column",{attrs:{prop:"type",label:"类型","min-width":"25","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"object",label:"对象","min-width":"55","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(" "+t._s(e.row.object.kind)+"/"+t._s(e.row.object.name)+" ")])]}}],null,!1,1803908363)}),a("el-table-column",{attrs:{prop:"reason",label:"原因","min-width":"50","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(" "+t._s(e.row.reason?e.row.reason:"—")+" ")])]}}],null,!1,548534711)}),a("el-table-column",{attrs:{prop:"message",label:"信息","min-width":"120","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(" "+t._s(e.row.message?e.row.message:"—")+" ")])]}}],null,!1,2501580055)}),a("el-table-column",{attrs:{prop:"event_time",label:"触发时间","min-width":"50","show-overflow-tooltip":""}})],1):a("div",{staticStyle:{padding:"25px 15px",color:"#909399","text-align":"center"}},[t._v("暂无事件发生")])],1)])],1),a("el-dialog",{attrs:{title:"终端",visible:t.terminalDialog,"close-on-click-modal":!1,width:"80%",top:"55px"},on:{"update:visible":function(e){t.terminalDialog=e}}},[t.terminalDialog?a("terminal",{attrs:{cluster:t.cluster,namespace:t.namespace,pod:t.selectPodName,container:t.selectContainer}}):t._e()],1),a("el-dialog",{attrs:{title:"日志",visible:t.logDialog,"close-on-click-modal":!1,width:"80%",top:"55px"},on:{"update:visible":function(e){t.logDialog=e}}},[t.logDialog?a("log",{attrs:{cluster:t.cluster,namespace:t.namespace,pod:t.selectPodName,container:t.selectContainer}}):t._e()],1),a("el-dialog",{attrs:{title:"编辑",visible:t.yamlDialog,"close-on-click-modal":!1,width:"60%",top:"55px"},on:{"update:visible":function(e){t.yamlDialog=e}}},[t.yamlDialog?a("yaml",{attrs:{loading:t.yamlLoading},model:{value:t.yamlValue,callback:function(e){t.yamlValue=e},expression:"yamlValue"}}):t._e(),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{plain:"",size:"small"},on:{click:function(e){t.yamlDialog=!1}}},[t._v("取 消")]),a("el-button",{attrs:{plain:"",size:"small"},on:{click:function(e){return t.updateStatefulSet()}}},[t._v("确 定")])],1)],1)],1)],1)},n=[],o=(a("99af"),a("4de4"),a("b0c0"),a("b85c")),r=a("61b2"),i=a("f321"),l=a("0905"),c=a("f492"),u=a("5c96"),d={name:"StatefulSetDetail",components:{Clusterbar:r["a"],Terminal:r["d"],Log:r["c"],Yaml:r["f"]},data:function(){return{logContainerShow:!1,termContainerShow:!1,yamlDialog:!1,yamlValue:"",yamlLoading:!0,logDialog:!1,terminalDialog:!1,cellStyle:{border:0},loading:!0,originStatefulset:void 0,pods:[],selectContainer:"",selectPodName:"",statefulsetEvents:[],eventLoading:!0,envStr:c["e"],resourceFor:c["i"]}},created:function(){this.fetchData()},watch:{statefulsetWatch:function(t){if(t&&this.originStatefulset){var e=t.resource.metadata.uid;if(e!==this.statefulset.uid)return;var a=t.resource.metadata.resourceVersion;this.statefulset.resource_version<a&&(this.originStatefulset=t.resource)}},eventWatch:function(t){if(t&&this.originStatefulset){var e=t.resource;if(e.involvedObject.namespace!==this.statefulset.namespace)return;if(e.involvedObject.uid!==this.statefulset.uid)return;var a=t.resource.metadata.uid;if("add"===t.event)this.statefulsetEvents.push(Object(l["a"])(e));else if("update"==t.event){var s=t.resource.metadata.resourceVersion;for(var n in this.statefulsetEvents){var o=this.statefulsetEvents[n];if(o.uid===a){if(o.resource_version<s){var r=Object(l["a"])(t.resource);this.$set(this.statefulsetEvents,n,r)}break}}}else"delete"===t.event&&(this.statefulsetEvents=this.statefulsetEvents.filter((function(t){var e=t.uid;return e!==a})))}},podsWatch:function(t){if(t&&this.originStatefulset){var e=Object(c["h"])(this.originStatefulset.spec.selector,t.resource.metadata.labels);if(e){var a=t.resource.metadata.uid,s=t.resource.metadata.resourceVersion;if("add"===t.event)this.pods.push(Object(c["b"])(t.resource));else if("update"===t.event)for(var n in this.pods){var o=this.pods[n];if(o.uid===a&&o.resource_version<s){var r=Object(c["b"])(t.resource);this.$set(this.pods,n,r);break}}else"delete"===t.event&&(this.pods=this.pods.filter((function(t){var e=t.uid;return e!==a})))}}}},computed:{titleName:function(){return["StatefulSets",this.statefulsetName]},statefulsetName:function(){return this.$route.params?this.$route.params.statefulsetName:""},namespace:function(){return this.$route.params?this.$route.params.namespace:""},statefulset:function(){var t=this.buildStatefulSet(this.originStatefulset);return t},cluster:function(){return this.$store.state.cluster},statefulsetWatch:function(){return this.$store.getters["ws/statefulsetWatch"]},eventWatch:function(){return this.$store.getters["ws/eventWatch"]},podsWatch:function(){return this.$store.getters["ws/podWatch"]},containers:function(){if(!this.originStatefulset)return[];var t,e=[],a=this.originStatefulset.spec.template,s=Object(o["a"])(a.spec.containers);try{for(s.s();!(t=s.n()).done;){var n=t.value,r=Object(c["a"])(n);e.push(r)}}catch(m){s.e(m)}finally{s.f()}var i=[];if(a.spec.initContainers){var l,u=Object(o["a"])(a.spec.initContainers);try{for(u.s();!(l=u.n()).done;){var d=l.value;i.push(Object(c["a"])(d))}}catch(m){u.e(m)}finally{u.f()}}return[].concat(i,e)}},methods:{fetchData:function(){var t=this;this.originStatefulset=null,this.statefulsetEvents=[],this.loading=!0,this.eventLoading=!0;var e=this.$store.state.cluster;return e?this.namespace?this.statefulsetName?void Object(i["b"])(e,this.namespace,this.statefulsetName).then((function(a){t.originStatefulset=a.data,Object(c["g"])(e,t.originStatefulset.spec.selector).then((function(e){t.loading=!1,t.pods=e.data})).catch((function(){t.loading=!1})),Object(l["b"])(e,t.originStatefulset.metadata.uid).then((function(e){t.eventLoading=!1,e.data&&(t.statefulsetEvents=e.data.length>0?e.data:[])})).catch((function(){t.eventLoading=!1}))})).catch((function(){t.loading=!1,t.eventLoading=!1})):(u["Message"].error("获取Statefulset名称参数异常，请刷新重试"),this.loading=!1,void(this.eventLoading=!1)):(u["Message"].error("获取命名空间参数异常，请刷新重试"),this.loading=!1,void(this.eventLoading=!1)):(u["Message"].error("获取集群参数异常，请刷新重试"),this.loading=!1,void(this.eventLoading=!1))},buildStatefulSet:function(t){if(!t)return{};var e={uid:t.metadata.uid,namespace:t.metadata.namespace,name:t.metadata.name,replicas:t.spec.replicas,status_replicas:t.status.replicas||0,ready_replicas:t.status.readyReplicas||0,resource_version:t.metadata.resourceVersion,strategy:t.spec.updateStrategy.type,conditions:t.status.conditions,created:t.metadata.creationTimestamp,label_selector:t.spec.selector,labels:t.metadata.labels,annotations:t.metadata.annotations,volumes:t.spec.template.spec.volumes};return e},toogleExpand:function(t){var e=this.$refs.table;e.toggleRowExpansion(t)},deleteStatefulSets:function(){var t=this.$store.state.cluster;if(t){this.statefulset||u["Message"].error("获取Statefulset参数异常，请刷新重试");var e=[{namespace:this.statefulset.namespace,name:this.statefulset.name}],a={resources:e};Object(i["a"])(t,a).then((function(){u["Message"].success("删除成功")})).catch((function(){}))}else u["Message"].error("获取集群参数异常，请刷新重试")},getStatefulSetYaml:function(){var t=this;if(this.statefulset){var e=this.$store.state.cluster;e?(this.yamlValue="",this.yamlDialog=!0,this.yamlLoading=!0,Object(i["b"])(e,this.statefulset.namespace,this.statefulset.name,"yaml").then((function(e){t.yamlLoading=!1,t.yamlValue=e.data})).catch((function(){t.yamlLoading=!1}))):u["Message"].error("获取集群参数异常，请刷新重试")}else u["Message"].error("获取Statefulset参数异常，请刷新重试")},updateStatefulSet:function(){if(this.statefulset){var t=this.$store.state.cluster;t?(console.log(this.yamlValue),Object(i["d"])(t,this.statefulset.namespace,this.statefulset.name,this.yamlValue).then((function(){u["Message"].success("更新成功")})).catch((function(){}))):u["Message"].error("获取集群参数异常，请刷新重试")}else u["Message"].error("获取Statefulset参数异常，请刷新重试")},containerClass:function(t){return Object(c["c"])(t)},namePodClick:function(t,e){this.$router.push({name:"podsDetail",params:{namespace:t,podName:e}})},deletePods:function(t){var e=this.$store.state.cluster;if(e)if(t.length<=0)u["Message"].error("请选择要删除的Pod");else{var a={resources:t};Object(c["d"])(e,a).then((function(){u["Message"].success("删除成功")})).catch((function(){}))}else u["Message"].error("获取集群参数异常，请刷新重试")}}},m=d,p=(a("6720"),a("ab8a"),a("2877")),f=Object(p["a"])(m,s,n,!1,null,"1c99d3de",null);e["default"]=f.exports},ab8a:function(t,e,a){"use strict";var s=a("6193"),n=a.n(s);n.a},cc8c:function(t,e,a){},d63a:function(t,e,a){"use strict";const s=Function.call.bind(Object.prototype.hasOwnProperty);function n(t){const e=t.trim().split(" "),a=e[0],s=e[1],n=e[2],o=(n||"").slice(1,-1).split(",").map(t=>t.trim());switch(s){case void 0:return"!"===a[0]?{operator:"DoesNotExist",key:a.slice(1)}:{operator:"Exists",key:a};case"=":case"==":return{operator:"=",key:a,value:n};case"!=":return{operator:"NotIn",values:[n],key:a};case"in":return{operator:"In",key:a,values:o};case"notin":return{operator:"NotIn",key:a,values:o};default:}throw new Error("Invalid expression: "+t)}function o(t){const e=t.split(/,(?![^(]*\))/).map(n),a=e.filter(t=>s(t,"value")).reduce((t,e)=>Object.assign(t,{[e.key]:e.value}),{}),o=e.filter(t=>!s(t,"value"));return{matchLabels:a,matchExpressions:o}}function r(t){const e=t.operator.toLowerCase(),a=t.key,s=t.values;switch(e){case"exists":return a;case"doesnotexist":return"!"+a;default:}return`${a} ${e} (${s.join(",")})`}function i(t){const e=t.matchLabels||{},a=t.matchExpressions||[];return Object.keys(e).map(t=>`${t} = ${e[t]}`).concat(a.map(r)).join(",")}function l(t){if("string"===typeof t)return l(o(t));const e=t.matchExpressions||[],a=t.matchLabels||{};return Object.keys(a).map(t=>({operator:"In",key:t,values:[a[t]]})).concat(e)}function c(t,e){const a=t.operator,n=t.key,o=t.values,r=e[n];switch(a){case"Exists":return s(e,n);case"DoesNotExist":return!s(e,n);case"In":return o.indexOf(r)>=0;case"NotIn":return o.indexOf(r)<0;default:}throw new Error("Invalid operator: "+a)}function u(t){const e=l(t);return t=>e.every(e=>c(e,t||{}))}t.exports={stringify:i,parse:o,Selector:u}},f321:function(t,e,a){"use strict";a.d(e,"c",(function(){return n})),a.d(e,"b",(function(){return o})),a.d(e,"a",(function(){return r})),a.d(e,"d",(function(){return i})),a.d(e,"e",(function(){return l}));a("99af");var s=a("b775");function n(t){return Object(s["a"])({url:"statefulset/".concat(t),method:"get"})}function o(t,e,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return Object(s["a"])({url:"statefulset/".concat(t,"/").concat(e,"/").concat(a),method:"get",params:{output:n}})}function r(t,e){return Object(s["a"])({url:"statefulset/".concat(t,"/delete"),method:"post",data:e})}function i(t,e,a,n){return Object(s["a"])({url:"statefulset/".concat(t,"/update/").concat(e,"/").concat(a),method:"post",data:{yaml:n}})}function l(t,e,a,n){return Object(s["a"])({url:"statefulset/".concat(t,"/update_obj/").concat(e,"/").concat(a),method:"post",data:n})}},f492:function(t,e,a){"use strict";a.d(e,"h",(function(){return r})),a.d(e,"g",(function(){return i})),a.d(e,"f",(function(){return l})),a.d(e,"d",(function(){return c})),a.d(e,"j",(function(){return u})),a.d(e,"c",(function(){return d})),a.d(e,"a",(function(){return m})),a.d(e,"b",(function(){return p})),a.d(e,"i",(function(){return f})),a.d(e,"e",(function(){return v}));a("99af"),a("b0c0");var s=a("b85c"),n=a("b775"),o=a("d63a");function r(t,e){var a=Object(o["Selector"])(t);return console.log(a,t,e),a(e)}function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s={};return e&&(s["label_selector"]=e),a&&(s["names"]=a),Object(n["a"])({url:"pods/".concat(t,"/list"),method:"post",data:s})}function l(t,e,a){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return Object(n["a"])({url:"pods/".concat(t,"/").concat(e,"/").concat(a),method:"get",params:{output:s}})}function c(t,e){return Object(n["a"])({url:"pods/".concat(t,"/delete"),method:"post",data:e})}function u(t,e,a,s){return Object(n["a"])({url:"pods/".concat(t,"/update/").concat(e,"/").concat(a),method:"post",data:{yaml:s}})}function d(t){return"running"===t?"running-class":"terminated"===t?"terminate-class":"waiting"===t?"waiting-class":void 0}function m(t,e){if(!t)return{};var a={name:t.name,status:"unknown",image:t.image,restarts:0,command:t.command?t.command:[],args:t.args?t.args:[],ports:t.ports?t.ports:[],env:t.env?t.env:[],volume_mounts:t.volumeMounts?t.volumeMounts:[],image_pull_policy:t.imagePullPolicy?t.imagePullPolicy:"",resources:t.resources?t.resources:{},start_time:"",liveness_probe:t.livenessProbe,readiness_probe:t.readinessProbe};if(e){var n,o=Object(s["a"])(e);try{for(o.s();!(n=o.n()).done;){var r=n.value;if(r.name==t.name){a.restarts=r.restartCount,r.state.running?(a.status="running",a.start_time=r.state.running.startedAt):r.state.terminated?(a.status="terminated",a.start_time=r.state.terminated.startedAt):r.state.waiting&&(a.status="waiting"),a.ready=r.ready;break}}}catch(i){o.e(i)}finally{o.f()}}return a}function p(t){if(!t)return{};var e,a=[],n=Object(s["a"])(t.spec.containers);try{for(n.s();!(e=n.n()).done;){var o=e.value,r=m(o,t.status.containerStatuses);a.push(r)}}catch(b){n.e(b)}finally{n.f()}var i=[];if(t.spec.initContainers){var l,c=Object(s["a"])(t.spec.initContainers);try{for(c.s();!(l=c.n()).done;){var u=l.value;i.push(m(u,t.status.initContainerStatuses))}}catch(b){c.e(b)}finally{c.f()}}var d="",p="";t.metadata.ownerReferences&&t.metadata.ownerReferences.length>0&&(d=t.metadata.ownerReferences[0].kind,p=t.metadata.ownerReferences[0].name);var f={uid:t.metadata.uid,name:t.metadata.name,namespace:t.metadata.namespace,containers:a,init_containers:i,controlled:d,controlled_name:p,qos:t.status.qosClass,status:t.status.phase,ip:t.status.podIP,created:t.metadata.creationTimestamp,node_name:t.spec.nodeName,resource_version:t.metadata.resourceVersion,labels:t.metadata.labels,annonations:t.metadata.annotations,service_account:t.spec.serviceAccountName||t.spec.serviceAccount,node_selector:t.spec.nodeSelector,volumes:t.spec.volumes,conditions:t.status.conditions};f["containerNum"]=f.containers.length,f.init_containers&&(f["containerNum"]+=f.init_containers.length),f["restarts"]=0;var v,h=Object(s["a"])(f.containers);try{for(h.s();!(v=h.n()).done;){var g=v.value;g.restarts>f["restarts"]&&(f["restarts"]=g.restarts)}}catch(b){h.e(b)}finally{h.f()}return f}function f(t,e,a){return e in t&&a in t[e]?t[e][a]:"-"}function v(t){var e=t.name+": ";return t.value?e+=t.value:t.valueFrom&&(t.valueFrom.configMapKeyRef?e+="configmap(".concat(t.valueFrom.configMapKeyRef.key,":").concat(t.valueFrom.configMapKeyRef.name,")"):t.valueFrom.fieldRef?e+="fieldRef(".concat(t.valueFrom.fieldRef.apiVersion,":").concat(t.valueFrom.fieldRef.fieldPath,")"):t.valueFrom.secretKeyRef?e+="secret(".concat(t.valueFrom.secretKeyRef.key,":").concat(t.valueFrom.secretKeyRef.name,")"):e+=String(t.valueFrom)),e}}}]);